[package]
authors = ["Ryo ∴ SpiralArchitect <kishkavsesvit@icloud.com>"]
name = "st-tensor"
version = "0.1.0"
edition = "2021"
description = "SpiralTorch tensor utilities: fractional calculus (GL 1D) CPU + optional WGPU kernel"
license = "AGPL-3.0-or-later"

[lib]
crate-type = ["rlib", "cdylib"]

[features]
default = ["cpu"]
faer = ["dep:faer"]

# CPU execution is always available, but expose a feature so that downstream
# crates can opt into a uniform interface when selecting backends.
cpu = []

# Keep the granular feature name for the fractional WGPU kernels while also
# providing the alias expected by the Python bindings (and end users invoking
# `--features wgpu`).
wgpu_frac = ["dep:wgpu", "dep:bytemuck", "dep:pollster"]
wgpu = ["wgpu_frac"]

# Placeholder features for other accelerators.  These currently do not pull in
# additional dependencies but allow higher level crates to enable them without
# Cargo feature resolution failures.
mps = []
cuda = []
hip = []

[dependencies]
# Deterministic sampling helpers for pure tensor stochastic initialisers.
rand = { version = "0.8", default-features = false, features = ["std"] }
rand_distr = { version = "0.4", default-features = false, features = ["std"] }
# High-performance SIMD dense linear algebra for CPU matmul acceleration.
faer = { version = "0.18", default-features = false, features = ["std"], optional = true }
# Deterministic RNGs for pure tensor initialisers.
rand = { version = "0.8", features = ["std"] }
# Optional; only needed if building WGPU kernel
wgpu = { version = "0.19", optional = true }
bytemuck = { version = "1.15", features = ["derive"], optional = true }
pollster = { version = "0.3", optional = true }

[dev-dependencies]
# Used in tests to validate conversions against ndarray utilities.
ndarray = { version = "0.15" }
# Criterion + Plotters power the tensor initialisation benchmarks.
criterion = { version = "0.5", features = ["html_reports"] }
plotters = { version = "0.3" }

[[bench]]
name = "random_init"
harness = false

[package.metadata.spiraltorch]
copyright = "© 2025 Ryo ∴ SpiralArchitect — All rights reserved"
